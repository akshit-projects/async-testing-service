{
  "name": "SQL Validation Test Flow",
  "description": "Tests SQL query validation with allowed and restricted tables",
  "creator": "system@example.com",
  "orgId": "org-sample-1",
  "teamId": "team-sample-1",
  "steps": [
    {
      "name": "validUserQuery",
      "stepType": "sql",
      "meta": {
        "resourceId": "resource-db-1",
        "query": "SELECT id, name, email FROM users WHERE status = 'active'",
        "expectedColumns": ["id", "name", "email"]
      },
      "timeoutMs": 5000,
      "runInBackground": false,
      "continueOnSuccess": true
    },
    {
      "name": "queryWithParameters",
      "stepType": "sql",
      "meta": {
        "resourceId": "resource-db-1",
        "query": "SELECT * FROM user_profiles WHERE user_id = ${userId} AND created_at > ${startDate}",
        "parameters": {
          "userId": "123",
          "startDate": "2024-01-01"
        },
        "expectedRowCount": 1
      },
      "timeoutMs": 5000,
      "runInBackground": false,
      "continueOnSuccess": true
    },
    {
      "name": "queryWithLimitTest",
      "stepType": "sql",
      "meta": {
        "resourceId": "resource-db-1",
        "query": "SELECT id, name FROM users ORDER BY created_at DESC",
        "expectedColumns": ["id", "name"]
      },
      "timeoutMs": 5000,
      "runInBackground": false,
      "continueOnSuccess": true
    },
    {
      "name": "cacheQueryResult",
      "stepType": "redis",
      "meta": {
        "resourceId": "resource-redis-1",
        "operation": "SET",
        "key": "user_count",
        "value": "${validUserQuery.rowCount}",
        "ttl": 300
      },
      "timeoutMs": 3000,
      "runInBackground": false,
      "continueOnSuccess": true
    },
    {
      "name": "verifyCache",
      "stepType": "redis",
      "meta": {
        "resourceId": "resource-redis-1",
        "operation": "GET",
        "key": "user_count",
        "expectedExists": true
      },
      "timeoutMs": 3000,
      "runInBackground": false,
      "continueOnSuccess": true
    }
  ]
}
